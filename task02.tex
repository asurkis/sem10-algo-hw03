\section{Задача 2}
Дан массив из $n$ чисел. Все операции по модулю фиксированного $M$.
Online запросы:
\begin{itemize}
    \item посчитать произведение всех чисел на отрезке $[L, R]$;
    \item присвоить значение $x$ всем числам на отрезке $[L, R]$.
\end{itemize}

Убедитесь, что ваше решение работает именно за $\O(\log n)$.

\subsection{Решение}
Рассмотрим следующий код на Rust.
В нём используются две ключевые идеи:
\begin{itemize}
    \item Если добить длину массива до $2^{\ceil{\log_2 n}}$, то все отрезки дерева отрезков будут степенями двойки,
    при этом $2^{\ceil{\log_2 n}} \in \Theta(n)$.
    \item Можно предподсчитать все $x^{2^k} \Mod M$ за $\O(\log n)$,
    поместить их в список в порядке убывания степени,
    и при спуске по дереву передавать хвост списка в вершине.
    Сам список при этом не копируется, а вершины хранятся со счётчиком ссылок,
    поэтому такая операция занимает $\O(1)$ времени на каждый уровень.
\end{itemize}

\inputminted[firstline=5]{rust}{code/src/task02/mod.rs}

Очевидно, инициализация происходит за $\O(\log n)$, каждый запрос --- за $\O(\log n)$.

Искомый алгоритм найден.
